    
    
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    
<style>
@font-face{font-family:Raleway;font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4WjNPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:200;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4ejMPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4TbMPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4WjMPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4VrMPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4bbLPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4Y_LPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4ejLPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4cHLPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvao4CP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:200;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVtaooCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVuEooCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvaooCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvoooCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVsEpYCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVs9pYCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVtapYCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVtzpYCP.ttf) format('truetype')}body{font:19px/1.6 Open Sans,Ubuntu,Nimbus Sans L,Avenir,AvenirNext,Segoe UI,Helvetica,Arial,sans-serif;color:#222}html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}a{background-color:transparent}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}*,:after,:before{box-sizing:inherit}html{box-sizing:border-box;font-size:62.5%}body{color:#606c76;font-family:Roboto,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:1.6em;font-weight:300;letter-spacing:.01em;line-height:1.6}hr{border-top:.1rem solid #f4f5f6}.container{margin:0 auto;max-width:112rem;padding:0 2rem;position:relative;width:100%}a{color:#9b4dca}p{margin-bottom:2.5rem}h1,p{margin-top:0}h1{font-weight:300;letter-spacing:-.1rem;margin-bottom:2rem}h1{font-size:4.6rem;line-height:1.2}html{min-height:100%;position:relative;-moz-text-size-adjust:none;-webkit-text-size-adjust:none;text-size-adjust:none;touch-action:manipulation}body,html{background-color:#fff}body{font:19px/1.6 Raleway,Helvetica,Arial,Lucida,sans-serif;color:#222}h1{page-break-after:avoid;page-break-inside:avoid}hr{border:0;border-top:.1rem solid #c62129;margin:3rem 0}a{color:#0070be;border-bottom:.08em solid rgba(0,0,0,.1);padding-bottom:.08em}a{text-decoration:none}main{-webkit-animation:1s fade-in;animation:1s fade-in}@-webkit-keyframes fade-in{0%{opacity:0}to{opacity:1}}@keyframes fade-in{0%{opacity:0}to{opacity:1}}header{text-align:center;margin-bottom:15px}.post header h1 a{color:#222;text-decoration:none;border-bottom:0}.post p:first-child:first-letter{float:left;font-family:Georgia;font-size:71px;line-height:50px;padding-top:5px;padding-right:8px}.ns-main{max-width:750px;padding:0 1.5em;margin:3% auto}.ns-post-summary{color:#000}.ns-readmore{margin-bottom:2.2em}.ns-tags,time{color:#626262;font-size:.85em}.pie{background:#000;border-radius:50%;box-shadow:0 0 4px 5px rgba(0,0,0,.2);height:400px;left:-200px;position:absolute;top:-200px;width:400px;transform:translateX(-200px) translateY(-200px);z-index:1}.pie1{-webkit-clip-path:polygon(200px 200px,344px 450px,0 450px);clip-path:polygon(200px 200px,344px 450px,0 450px)}.pie2{-webkit-clip-path:polygon(200px 200px,344px 450px,450px 344px);clip-path:polygon(200px 200px,344px 450px,450px 344px)}.pie3{-webkit-clip-path:polygon(200px 200px,450px 0,450px 344px);clip-path:polygon(200px 200px,450px 0,450px 344px)}.pie-color{width:100%;height:100%;border-radius:50%}.pie-color-hyperlink{font-size:1.7rem;letter-spacing:.05em;font-weight:700;color:#fff}.pie-color1{background:linear-gradient(135deg,#c62129,#c62129);-webkit-clip-path:polygon(200px 200px,344px 450px,0 450px);clip-path:polygon(200px 200px,344px 450px,0 450px)}.pie-color2{background:linear-gradient(135deg,#fff,#fff);-webkit-clip-path:polygon(200px 200px,344px 450px,450px 344px);clip-path:polygon(200px 200px,344px 450px,450px 344px)}.pie-color3{background:linear-gradient(135deg,#c62129,#c62129);-webkit-clip-path:polygon(200px 200px,450px 0,450px 344px);clip-path:polygon(200px 200px,450px 0,450px 344px)}.linkedin{left:208px;position:absolute;top:320px}.twitter{left:282px;top:279px}.rss,.twitter{position:absolute;width:46px}.rss{left:324px;top:210px}.menu{background:#fff;border-radius:50%;box-shadow:0 0 4px 5px rgba(0,0,0,.2);height:200px;left:-100px;position:absolute;top:-100px;width:200px;z-index:1}.hamburger{height:46px;left:58%;position:relative;top:58%;width:46px}.hamburger path:first-child{transform-origin:25% 29%}.hamburger path:nth-child(2){transform-origin:50% 50%}.hamburger path:nth-child(3){transform-origin:75% 72%}.hamburger path:nth-child(4){transform-origin:75% 29%}.hamburger path:nth-child(5){transform-origin:25% 72%}.hero-image{background-image:linear-gradient(rgba(0,0,0,.5),rgba(0,0,0,.5)),url('https://normansolutions.co.uk/img/BandHeader.jpg?v=fingerprint')}.hero-image{min-height:280px;height:50%;box-shadow:-5px 24px 65px -31px rgba(0,0,0,.75);background-position:50%;background-repeat:no-repeat;background-size:cover;position:relative}.hero-text{text-align:center;color:#fff;position:absolute;top:50%;left:50%;background-color:rgba(0,0,0,.5);padding:10px;margin-top:10px;margin-bottom:10px;border-radius:10px;transform:translate(-50%,-50%)}@media (min-width:1024px) and (max-width:1366px) and (orientation:portrait){.hero-text{width:80%}}@media (min-width:1024px) and (max-width:1366px) and (orientation:landscape){.hero-text{width:40%}}.hero-text a{color:#fff}.hero-text a,.hero-text a :visited{border-bottom:0}.ns-tagline{padding-top:25px;padding-left:15px;padding-right:15px}.ns-social,.ns-tagline{margin:auto;max-width:800px;position:relative;text-align:center}footer{position:fixed;color:#fff;height:45px;background-color:#000;bottom:0;text-align:center;width:100%;z-index:9999}footer p{padding-top:8px}
</style>


    <title>PowerShell Logging</title>
    <meta
      name="Keywords"
      content="Technology, IT, Education, Software, Security"
    />
    <meta
      name="Description"
      content="Head of Information Services, Web Technologist &amp;amp; Musician, based on the Wiltshire, Dorset &amp; Somerset border in the UK.  Offering honest independent advice on all things web, security and general IT; with a splash of added music for the soul."
    />

    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1"
    />
    <meta name="robots" content="index,follow" />
    <meta name="Author" content="normansolutions.co.uk" />
    <meta name="language" content="EN" />
    <meta name="Classification" content="" />
    <meta
      name="copyright"
      content="Copyright (c) 2025 'normansolutions.co.uk' All rights reserved."
    />
    <meta name="revisit-after" content="7 days" />
    <meta name="document-classification" content="Technology" />
    <meta name="document-type" content="Public" />
    <meta name="document-rating" content="Safe for Kids" />
    <meta name="document-distribution" content="Global" />
    <link rel="me" type="text/html" href="https://twitter.com/normansolutions" />
    <link
      type="application/rsd+xml"
      rel="edituri"
      title="RSD"
      href="robots.txt"
    />
    <link rel="canonical" href="https://normansolutions.co.uk" />
    <meta name="application-name" content="Normansolutions" />
    <meta name="msapplication-TileColor" content="#ffffff" />

    <meta property="og:title" content="NS News and Views" />
    <meta property="og:type" content=article />   
    <meta
      property="og:description"
      content="Head of Information Services, Web Technologist &amp;amp; Musician, based on the Wiltshire, Dorset &amp; Somerset border in the UK.  Offering honest independent advice on all things web, security and general IT; with a splash of added music for the soul."
    />
    <meta
      property="og:image"
      content="https://normansolutions.co.uk/appicons/Icon-568.jpg"
    />
    <meta property="og:url" content="https://normansolutions.co.uk" />
    <meta property=og:description content="Head of Information Services, Web Technologist &amp;amp; Musician, based on the Wiltshire, Dorset &amp; Somerset border in the UK.  Offering honest independent advice on all things web, security and general IT; with a splash of added music for the soul.">

    <meta name="twitter:title" content="NS News and Views" />
    <meta
      name="twitter:description"
      content="Head of Information Services, Web Technologist &amp;amp; Musician, based on the Wiltshire, Dorset &amp; Somerset border in the UK.  Offering honest independent advice on all things web, security and general IT; with a splash of added music for the soul."    />
    <meta name="twitter:image" content="/appicons/Icon-568.jpg" />
    <meta name="twitter:card" content="summary_large_image" />
    <link rel="manifest" href="/manifest.json" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    















<link
  rel="preload"
  href="/css/main.min.9ff434cabc68e238dd594ebfb90e9d03e352bee12f112f7bf735c66ffb4c8a83.css?v=ns-fingerprint"
  integrity="sha256-n/Q0yrxo4jjdWU6/uQ6dA&#43;NSvuEvES979zXGb/tMioM="
  as="style"
  crossorigin="anonymous"
/>
<link
  rel="stylesheet"
  href="/css/main.min.9ff434cabc68e238dd594ebfb90e9d03e352bee12f112f7bf735c66ffb4c8a83.css?v=ns-fingerprint"
  integrity="sha256-n/Q0yrxo4jjdWU6/uQ6dA&#43;NSvuEvES979zXGb/tMioM="
  media="print"
  onload="this.media='all'"
  crossorigin="anonymous"
/>

    

    
    <script>
      !(function (document) {
        "use strict";
        var webpImage,
          avifImage =
            "data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAF0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgS0AAAAAABNjb2xybmNseAACAAIAAIAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAGVtZGF0EgAKBzgAPtAgIAkyUBAAAPWc41TP///4gHBX9H8XVK7gGeDllq8TYARA+8Tfsv7L+zPE24eIoIzE0WhHbrqcrTK9VEgEG/hwgB5rdCbvP8g3KYPdV88CvPJnptgQ",
          webpClass = "webp",
          avifClass = "avif";
        function alreadyTested(format) {
          if (window.sessionStorage) {
            var test = window.sessionStorage.getItem(format + "Support");
            if ("false" === test || "true" === test) return "true" === test;
          }
          return null;
        }
        function testFormat(format, imageSrc, callback) {
          var tested = alreadyTested(format);
          if (null === tested) {
            var image = new Image();
            return (
              (image.onload = image.onerror = function () {
                callback(format, 2 === image.height);
              }),
              void (image.src = imageSrc)
            );
          }
          addClass(format, tested);
        }
        function addClass(format, support) {
          if (support) {
            var el = document.documentElement;
            el.classList
              ? el.classList.add("webp" === format ? "webp" : "avif")
              : (el.className += " " + format == "webp" ? "webp" : "avif"),
              window.sessionStorage.setItem(format + "Support", !0);
          } else window.sessionStorage.setItem(format + "Support", !1);
        }
        testFormat(
          "webp",
          "data:image/webp;base64,UklGRi4AAABXRUJQVlA4TCEAAAAvAUAAEB8wAiMwAgSSNtse/cXjxyCCmrYNWPwmHRH9jwMA",
          addClass
        ),
          testFormat("avif", avifImage, addClass);
      })(document);
    </script>

    <script src="https://polyfill.io/v2/polyfill.min.js?features=IntersectionObserver"></script>
  </head>
  <body itemscope itemtype=http://schema.org/WebPage></body>
</html>

    <div class="pie pie1" onclick="document.body.classList.remove('active')">
  <a href="https://www.linkedin.com/in/normansolutions" target="_blank">
    <div class="pie-color pie-color1">
      <span class="pie-color-hyperlink linkedin">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="46"
          height="46"
          viewBox="0 0 24 24"
        >
          <path
            d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"
          /></svg
      ></span>
    </div>
  </a>
</div>
<div class="pie pie2" onclick="document.body.classList.remove('active')">
  <a href="https://twitter.com/normansolutions" target="_blank">
    <div class="pie-color pie-color2">
      <span class="pie-color-hyperlink twitter">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="46"
          height="46"
          viewBox="0 0 24 24"
        >
          <path
            d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"
          />
        </svg>
      </span>
    </div>
  </a>
</div>
<div class="pie pie3" onclick="document.body.classList.remove('active')">
  <a href="/index.xml">
    <div class="pie-color pie-color3">
      <span class="pie-color-hyperlink rss">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="46"
          height="46"
          viewBox="0 0 24 24"
        >
          <path
            d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"
          />
        </svg>
      </span>
    </div>
  </a>
</div>
<div class="menu" onclick="document.body.classList.toggle('active')">
  <svg
    class="hamburger"
    xmlns="http://www.w3.org/2000/svg"
    width="100"
    height="100"
    viewBox="0 0 100 100"
  >
    <g fill="none" stroke="#000" stroke-width="7.999" stroke-linecap="round">
      <path d="M 55,26.000284 L 24.056276,25.999716" />
      <path d="M 24.056276,49.999716 L 75.943724,50.000284" />
      <path d="M 45,73.999716 L 75.943724,74.000284" />
      <path d="M 75.943724,26.000284 L 45,25.999716" />
      <path d="M 24.056276,73.999716 L 55,74.000284" />
    </g>
  </svg>
</div>

    <div class="hero-image">
  <div class="hero-text">
    <h1><a href="\">NS News &amp; Views</a></h1>
    <div class="ns-tagline">By Clive Norman</div>
    
    <h3>38 articles</h3>
    
  </div>
</div>

<div class="ns-social">
  <a target="_blank" href="https://www.linkedin.com/in/normansolutions">
    
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="64"
      height="64"
      viewBox="0 0 64 64"
    >
      <ellipse cy="32" cx="32" ry="32" rx="32" fill="#ffffff"></ellipse>
      <path
        id="path1"
        transform="rotate(0,32,32) translate(14.1963130235672,14) scale(1.450,1.450)  "
        fill="#C62129"
        d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"
      />
    </svg>
  </a>
  <a target="_blank" href="https://www.facebook.com/outoforderbanduk">
    
    <svg
    xmlns="http://www.w3.org/2000/svg"
    width="64"
    height="64"
    viewBox="0 0 64 64"
  >
    <ellipse cy="32" cx="32" ry="32" rx="32" fill="#ffffff"></ellipse>
    <path
      id="path1"
      transform="translate(20,14) scale(1.3,1.3)"
      fill="#C62129"
      d="M22 2v22.58A4.995 4.995 0 0 0 20 24c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5V9h8V2h-11z"
    />
  </svg>
  </a>

  <a target="_blank" href="/index.xml">
    
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="64"
      height="64"
      viewBox="0 0 64 64"
    >
      <ellipse cy="32" cx="32" ry="32" rx="32" fill="#ffffff"></ellipse>
      <path
        id="path1"
        transform="rotate(0,32,32) translate(14.1963130235672,14) scale(1.450,1.450)  "
        fill="#C62129"
        d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-12.832 20c-1.197 0-2.168-.969-2.168-2.165s.971-2.165 2.168-2.165 2.167.969 2.167 2.165-.97 2.165-2.167 2.165zm5.18 0c-.041-4.029-3.314-7.298-7.348-7.339v-3.207c5.814.041 10.518 4.739 10.561 10.546h-3.213zm5.441 0c-.021-7.063-5.736-12.761-12.789-12.792v-3.208c8.83.031 15.98 7.179 16 16h-3.211z"
      />
    </svg>
  </a>
</div>

    
    
<main itemprop="mainEntity" itemscope="" itemtype="http://schema.org/Blog" class="ns-main"> 
  <h1>PowerShell Logging</h1>
  <div class="ns-postdate">  
      <time datetime=2024-09-21&#32;19:00:20&#32;&#43;0000&#32;UTC itemprop="datePublished">Published Saturday, Sep 21, 2024</time>
      <span class="ns-tags">| Tags: <a href="/tags/powershell">PowerShell</a> <a href="/tags/azure">Azure</a> <a href="/tags/sysadmin">SysAdmin</a> </span>   
      <hr/>
    </div>
    <div id="ns-target">
      <p>Lately, I’ve been doing a lot of PowerShell scripting, and it’s given me the chance to expand my experience and exposure to best practices. One of the key areas I’ve focused on is logging — something that’s often overlooked but incredibly valuable when troubleshooting or reviewing script performance.</p>
<p>To make my life easier, I started adding a few basic functions at the top of my scripts. These functions would either log messages to a file, log to both the console and a file, or delete old log files that were over a certain age. As I implemented these functions more frequently, I realised it made sense to take this further and turn it into a reusable module.</p>
<p>So that’s exactly what I did. I built a PowerShell module that handles logging tasks efficiently and published it on the PowerShell Gallery. This is my first foray into submitting to the platform, and I’m pleased to be able to contribute something that may be useful to the community. Having the module available in the gallery not only streamlines my own work but also makes it easier for others who need similar logging capabilities.</p>
<p>If you&rsquo;re interested, you can check out my module in the <a href="https://www.powershellgallery.com/packages/NSLoggingModule/0.1.3">PowerShell Gallery (NSLoggingModule)</a>. Hopefully, it may save you time with some basic PowerShell logging!</p>
<p>Once the module is installed, you should have three functions available:</p>
<blockquote>
<h4 id="deleteoldlogfiles--days-int--logpath-string--scriptname-string"><!-- raw HTML omitted -->DeleteOldLogFiles (-days int) (-logPath string) (-scriptName string)<!-- raw HTML omitted --></h4>
<p>Deletes any log files in the log folder older than a set number of days - default is 90 days.</p></blockquote>
<blockquote>
<h4 id="log--message-string--logpath-string--scriptname-string"><!-- raw HTML omitted -->Log (-message string) (-logPath string) (-scriptName string)<!-- raw HTML omitted --></h4>
<p>Creates a log folder in logpath location (if doesn&rsquo;t already exist) - default is local Temp directory.<br>
Creates a log file within the log folder titled as device name, script name, and current date (e.g. <!-- raw HTML omitted -->computerName-scriptName-22-09-2024.log<!-- raw HTML omitted -->) - default script name is &ldquo;-&rdquo;.<br>
Each time the function is called, a timestamped line is created within the log file, pre-pended to whatever string is passed in.</p></blockquote>
<blockquote>
<h4 id="logandconsole--message-string--logpath-string--scriptname-string"><!-- raw HTML omitted -->LogAndConsole (-message string) (-logPath string) (-scriptName string)<!-- raw HTML omitted --></h4>
<p>Logs to file (as above) but also writes out to the console.</p></blockquote>
<p><em>(it&rsquo;s worth noting that you do need to pass in the logpath (and script name if required) on each line otherwise the default will be the local Temp directory. In my example I just assign the logpath and scriptname to variables for re-use)</em></p>


<img
src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="
data-src="/img/postimg/LogPathExample.png"/>




<hr/>


<h4 id="script-used-in-module">Script used in module</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#region LOGGING</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get the computer name</span>
</span></span><span style="display:flex;"><span>$computerName = $Env:COMPUTERNAME
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#region LOGGING FUNCTIONS</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Function to create log entries</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Log {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;#
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .</span><span style="color:#e6db74">SYNOPSIS</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    Creates a log entry.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .</span><span style="color:#e6db74">DESCRIPTION</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    This function creates a log entry with the current date and time in universal format and appends it to the log file.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .PARAMETER message
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    The message to log.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .PARAMETER logPath
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    The path to log file. Default is Temp.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .PARAMETER scriptName
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    The name of the script. Default is -
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .</span><span style="color:#e6db74">EXAMPLE</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    Log -message &#34;This is a log entry.&#34; -logPath &#34;./&#34; -scriptName &#34;logfile&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    #&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">param</span> (
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">string</span>]$message, <span style="color:#75715e"># Message to log</span>
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">string</span>]$logPath = <span style="color:#e6db74">&#34;</span>$env:Temp<span style="color:#e6db74">\&#34;</span>, <span style="color:#75715e"># Log path</span>
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">string</span>]$scriptName = <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#75715e"># File path</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Set the log folder path based on the provided or default path, with a &#34;Logs&#34; subfolder</span>
</span></span><span style="display:flex;"><span>    $logFolder = Join-Path -Path $logPath -ChildPath <span style="color:#e6db74">&#34;Logs&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Set the log file name based on the computer name, script name, and current date</span>
</span></span><span style="display:flex;"><span>    $logFileName = <span style="color:#e6db74">&#34;</span>$computerName<span style="color:#e6db74">-</span>$scriptName<span style="color:#e6db74">-</span>$(Get-Date -Format <span style="color:#e6db74">&#39;dd-MM-yy&#39;</span>)<span style="color:#e6db74">.log&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Check if the log folder exists, and create it if it doesn&#39;t</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">-not</span> (Test-Path -Path $logFolder)) {
</span></span><span style="display:flex;"><span>        New-Item -Path $logFolder -ItemType Directory | Out-Null
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Create log entry</span>
</span></span><span style="display:flex;"><span>    $currentTime = Get-Date -Format u  <span style="color:#75715e"># Get the current date/time in universal format</span>
</span></span><span style="display:flex;"><span>    $outputString = <span style="color:#e6db74">&#34;[</span>$currentTime<span style="color:#e6db74">] </span>$message<span style="color:#e6db74">&#34;</span>  <span style="color:#75715e"># Format the log entry</span>
</span></span><span style="display:flex;"><span>    $outputString | Out-File -FilePath (Join-Path -Path $logFolder -ChildPath $logFileName) -Append  <span style="color:#75715e"># Append to log file</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Function to log messages to both the console and the file</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> LogAndConsole {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;#
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .</span><span style="color:#e6db74">SYNOPSIS</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    Logs messages to both the console and the file.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .</span><span style="color:#e6db74">DESCRIPTION</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    This function logs messages to both the console with green text and to the log file.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .PARAMETER message
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    The message to log.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .PARAMETER logPath
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    The path to log file. Default is Temp.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .PARAMETER scriptName
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    The name of the script. Default is -
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .</span><span style="color:#e6db74">EXAMPLE</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    Log -message &#34;This is a log entry.&#34; -logPath &#34;./&#34; -scriptName &#34;logfile&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    #&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">param</span> (
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">string</span>]$message, <span style="color:#75715e"># Message to log</span>
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">string</span>]$logPath = <span style="color:#e6db74">&#34;</span>$env:Temp<span style="color:#e6db74">\&#34;</span>, <span style="color:#75715e"># Log path</span>
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">string</span>]$scriptName = <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#75715e"># File name</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Write-Host $message -ForegroundColor Green  <span style="color:#75715e"># Log to console</span>
</span></span><span style="display:flex;"><span>    Log -message $message -logPath $logPath -scriptName $scriptName <span style="color:#75715e"># Log to file</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Function to delete old log files</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> DeleteOldLogFiles {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;#
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .</span><span style="color:#e6db74">SYNOPSIS</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    Deletes old log files.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .</span><span style="color:#e6db74">DESCRIPTION</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    This function deletes log files older than the specified number of days.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .PARAMETER Days
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    The number of days after which log files will be deleted. Default is 90 days.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .PARAMETER logPath
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    The path to log file. Default is Temp
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    .</span><span style="color:#e6db74">EXAMPLE</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    DeleteOldLogFiles -Days 30 -logPath &#34;./&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    #&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">param</span> (
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">int</span>]$Days = <span style="color:#ae81ff">90</span>, <span style="color:#75715e"># Number of days after which log files will be deleted</span>
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">string</span>]$logPath = <span style="color:#e6db74">&#34;</span>$env:Temp<span style="color:#e6db74">\&#34;</span>, <span style="color:#75715e"># Log path</span>
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">string</span>]$scriptName = <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#75715e"># File name</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Set the log folder path based on the provided or default path</span>
</span></span><span style="display:flex;"><span>    $logFolder = Join-Path -Path $logPath -ChildPath <span style="color:#e6db74">&#34;Logs&#34;</span>
</span></span><span style="display:flex;"><span>    $logFiles = Get-ChildItem -Path (Join-Path -Path $logFolder -ChildPath <span style="color:#e6db74">&#34;*.log&#34;</span>)  <span style="color:#75715e"># Get all log files</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">foreach</span> ($file <span style="color:#66d9ef">in</span> $logFiles) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ($file.LastWriteTime <span style="color:#f92672">-le</span> (Get-Date).AddDays(-$Days)) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Delete log files older than the specified number of days</span>
</span></span><span style="display:flex;"><span>            LogAndConsole -message <span style="color:#e6db74">&#34;[+] Deleting old log file </span>$file<span style="color:#e6db74">...&#34;</span> -logPath $logPath -scriptName $scriptName
</span></span><span style="display:flex;"><span>            Remove-Item -Path $file.FullName  <span style="color:#75715e"># Remove the old log file</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#endregion LOGGING FUNCTIONS</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#endregion LOGGING</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Export only the public function</span>
</span></span><span style="display:flex;"><span>Export-ModuleMember -Function Log, LogAndConsole, DeleteOldLogFiles
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Example usage</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># $p = &#39;./&#39; (store log path as variable)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># $s = &#34;LogFileName&#34; (store file name as variable)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># DeleteOldLogFiles -days 30 -logpath $p -scriptName $s (named parameters example)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># LogAndConsole &#34;HelloTwo&#34; $p (positional parameters example)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Log &#34;HelloTemp&#34; (default file and path example)</span>
</span></span></code></pre></div><hr>
 
    </div>
<button class="ns-share-btn" type="button" title="Share this article">
  <svg class="ns-share-icon">
    <use href="#share-icon"></use>
  </svg>
  <span>Share Article</span>
</button>

<svg class="ns-hidden">
  <defs>
    <symbol id="share-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-share"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" y1="2" x2="12" y2="15"></line></symbol> 
   </defs>
</svg>
 </main>
 
   
    <div style="height: 35px"></div>
<footer>
  <div>
    <p>Copyright (c) 2025 Normansolutions</p>
  </div>
</footer>
  
    <script>
    if('serviceWorker' in navigator) {
        navigator.serviceWorker
            .register('/sw.js', { scope: '/' })
            .then(function(registration) {
                
            });
  
        navigator.serviceWorker
            .ready
            .then(function(registration) {
                
            });
    }
  </script>
    






<script
  src="/js/bundle.min.687393ed5d02ad59aaea69fafefb07c4c20dd118b8b01f9ba380cb1330ecd1ea.js?v=ns-fingerprint"
  integrity="sha256-aHOT7V0CrVmq6mn6/vsHxMIN0Ri4sB&#43;bo4DLEzDs0eo="
  defer
  crossorigin="anonymous"
></script>

    <script
  async
  src="https://www.googletagmanager.com/gtag/js?id=UA-37453744-1"
></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());
  gtag("config", "UA-37453744-1");
</script>

    