    
    
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    
<style>
@font-face{font-family:Raleway;font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4WjNPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:200;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4ejMPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4TbMPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4WjMPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4VrMPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4bbLPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4Y_LPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4ejLPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4cHLPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvao4CP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:200;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVtaooCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVuEooCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvaooCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvoooCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVsEpYCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVs9pYCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVtapYCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVtzpYCP.ttf) format('truetype')}body{font:19px/1.6 Open Sans,Ubuntu,Nimbus Sans L,Avenir,AvenirNext,Segoe UI,Helvetica,Arial,sans-serif;color:#222}html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}a{background-color:transparent}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}*,:after,:before{box-sizing:inherit}html{box-sizing:border-box;font-size:62.5%}body{color:#606c76;font-family:Roboto,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:1.6em;font-weight:300;letter-spacing:.01em;line-height:1.6}hr{border-top:.1rem solid #f4f5f6}.container{margin:0 auto;max-width:112rem;padding:0 2rem;position:relative;width:100%}a{color:#9b4dca}p{margin-bottom:2.5rem}h1,p{margin-top:0}h1{font-weight:300;letter-spacing:-.1rem;margin-bottom:2rem}h1{font-size:4.6rem;line-height:1.2}html{min-height:100%;position:relative;-moz-text-size-adjust:none;-webkit-text-size-adjust:none;text-size-adjust:none;touch-action:manipulation}body,html{background-color:#fff}body{font:19px/1.6 Raleway,Helvetica,Arial,Lucida,sans-serif;color:#222}h1{page-break-after:avoid;page-break-inside:avoid}hr{border:0;border-top:.1rem solid #c62129;margin:3rem 0}a{color:#0070be;border-bottom:.08em solid rgba(0,0,0,.1);padding-bottom:.08em}a{text-decoration:none}main{-webkit-animation:1s fade-in;animation:1s fade-in}@-webkit-keyframes fade-in{0%{opacity:0}to{opacity:1}}@keyframes fade-in{0%{opacity:0}to{opacity:1}}header{text-align:center;margin-bottom:15px}.post header h1 a{color:#222;text-decoration:none;border-bottom:0}.post p:first-child:first-letter{float:left;font-family:Georgia;font-size:71px;line-height:50px;padding-top:5px;padding-right:8px}.ns-main{max-width:750px;padding:0 1.5em;margin:3% auto}.ns-post-summary{color:#000}.ns-readmore{margin-bottom:2.2em}.ns-tags,time{color:#626262;font-size:.85em}.pie{background:#000;border-radius:50%;box-shadow:0 0 4px 5px rgba(0,0,0,.2);height:400px;left:-200px;position:absolute;top:-200px;width:400px;transform:translateX(-200px) translateY(-200px);z-index:1}.pie1{-webkit-clip-path:polygon(200px 200px,344px 450px,0 450px);clip-path:polygon(200px 200px,344px 450px,0 450px)}.pie2{-webkit-clip-path:polygon(200px 200px,344px 450px,450px 344px);clip-path:polygon(200px 200px,344px 450px,450px 344px)}.pie3{-webkit-clip-path:polygon(200px 200px,450px 0,450px 344px);clip-path:polygon(200px 200px,450px 0,450px 344px)}.pie-color{width:100%;height:100%;border-radius:50%}.pie-color-hyperlink{font-size:1.7rem;letter-spacing:.05em;font-weight:700;color:#fff}.pie-color1{background:linear-gradient(135deg,#c62129,#c62129);-webkit-clip-path:polygon(200px 200px,344px 450px,0 450px);clip-path:polygon(200px 200px,344px 450px,0 450px)}.pie-color2{background:linear-gradient(135deg,#fff,#fff);-webkit-clip-path:polygon(200px 200px,344px 450px,450px 344px);clip-path:polygon(200px 200px,344px 450px,450px 344px)}.pie-color3{background:linear-gradient(135deg,#c62129,#c62129);-webkit-clip-path:polygon(200px 200px,450px 0,450px 344px);clip-path:polygon(200px 200px,450px 0,450px 344px)}.linkedin{left:208px;position:absolute;top:320px}.twitter{left:282px;top:279px}.rss,.twitter{position:absolute;width:46px}.rss{left:324px;top:210px}.menu{background:#fff;border-radius:50%;box-shadow:0 0 4px 5px rgba(0,0,0,.2);height:200px;left:-100px;position:absolute;top:-100px;width:200px;z-index:1}.hamburger{height:46px;left:58%;position:relative;top:58%;width:46px}.hamburger path:first-child{transform-origin:25% 29%}.hamburger path:nth-child(2){transform-origin:50% 50%}.hamburger path:nth-child(3){transform-origin:75% 72%}.hamburger path:nth-child(4){transform-origin:75% 29%}.hamburger path:nth-child(5){transform-origin:25% 72%}.hero-image{background-image:linear-gradient(rgba(0,0,0,.5),rgba(0,0,0,.5)),url('https://normansolutions.co.uk/img/BandHeader.jpg?v=fingerprint')}.hero-image{min-height:280px;height:50%;box-shadow:-5px 24px 65px -31px rgba(0,0,0,.75);background-position:50%;background-repeat:no-repeat;background-size:cover;position:relative}.hero-text{text-align:center;color:#fff;position:absolute;top:50%;left:50%;background-color:rgba(0,0,0,.5);padding:10px;margin-top:10px;margin-bottom:10px;border-radius:10px;transform:translate(-50%,-50%)}@media (min-width:1024px) and (max-width:1366px) and (orientation:portrait){.hero-text{width:80%}}@media (min-width:1024px) and (max-width:1366px) and (orientation:landscape){.hero-text{width:40%}}.hero-text a{color:#fff}.hero-text a,.hero-text a :visited{border-bottom:0}.ns-tagline{padding-top:25px;padding-left:15px;padding-right:15px}.ns-social,.ns-tagline{margin:auto;max-width:800px;position:relative;text-align:center}footer{position:fixed;color:#fff;height:45px;background-color:#000;bottom:0;text-align:center;width:100%;z-index:9999}footer p{padding-top:8px}
</style>


    <title>Why I wrote a console app for accessing the iSAMS API</title>
    <meta
      name="Keywords"
      content="Technology, IT, Education, Software, Security"
    />
    <meta
      name="Description"
      content="Head of Information Services, Web Technologist &amp;amp; Musician, based on the Wiltshire, Dorset &amp; Somerset border in the UK.  Offering honest independent advice on all things web, security and general IT; with a splash of added music for the soul."
    />

    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1"
    />
    <meta name="robots" content="index,follow" />
    <meta name="Author" content="normansolutions.co.uk" />
    <meta name="language" content="EN" />
    <meta name="Classification" content="" />
    <meta
      name="copyright"
      content="Copyright (c) 2025 'normansolutions.co.uk' All rights reserved."
    />
    <meta name="revisit-after" content="7 days" />
    <meta name="document-classification" content="Technology" />
    <meta name="document-type" content="Public" />
    <meta name="document-rating" content="Safe for Kids" />
    <meta name="document-distribution" content="Global" />
    <link rel="me" type="text/html" href="https://twitter.com/normansolutions" />
    <link
      type="application/rsd+xml"
      rel="edituri"
      title="RSD"
      href="robots.txt"
    />
    <link rel="canonical" href="https://normansolutions.co.uk" />
    <meta name="application-name" content="Normansolutions" />
    <meta name="msapplication-TileColor" content="#ffffff" />

    <meta property="og:title" content="NS News and Views" />
    <meta property="og:type" content=article />   
    <meta
      property="og:description"
      content="Head of Information Services, Web Technologist &amp;amp; Musician, based on the Wiltshire, Dorset &amp; Somerset border in the UK.  Offering honest independent advice on all things web, security and general IT; with a splash of added music for the soul."
    />
    <meta
      property="og:image"
      content="https://normansolutions.co.uk/appicons/Icon-568.jpg"
    />
    <meta property="og:url" content="https://normansolutions.co.uk" />
    <meta property=og:description content="Head of Information Services, Web Technologist &amp;amp; Musician, based on the Wiltshire, Dorset &amp; Somerset border in the UK.  Offering honest independent advice on all things web, security and general IT; with a splash of added music for the soul.">

    <meta name="twitter:title" content="NS News and Views" />
    <meta
      name="twitter:description"
      content="Head of Information Services, Web Technologist &amp;amp; Musician, based on the Wiltshire, Dorset &amp; Somerset border in the UK.  Offering honest independent advice on all things web, security and general IT; with a splash of added music for the soul."    />
    <meta name="twitter:image" content="/appicons/Icon-568.jpg" />
    <meta name="twitter:card" content="summary_large_image" />
    <link rel="manifest" href="/manifest.json" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    















<link
  rel="preload"
  href="/css/main.min.9ff434cabc68e238dd594ebfb90e9d03e352bee12f112f7bf735c66ffb4c8a83.css?v=ns-fingerprint"
  integrity="sha256-n/Q0yrxo4jjdWU6/uQ6dA&#43;NSvuEvES979zXGb/tMioM="
  as="style"
  crossorigin="anonymous"
/>
<link
  rel="stylesheet"
  href="/css/main.min.9ff434cabc68e238dd594ebfb90e9d03e352bee12f112f7bf735c66ffb4c8a83.css?v=ns-fingerprint"
  integrity="sha256-n/Q0yrxo4jjdWU6/uQ6dA&#43;NSvuEvES979zXGb/tMioM="
  media="print"
  onload="this.media='all'"
  crossorigin="anonymous"
/>

    

    
    <script>
      !(function (document) {
        "use strict";
        var webpImage,
          avifImage =
            "data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAF0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgS0AAAAAABNjb2xybmNseAACAAIAAIAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAGVtZGF0EgAKBzgAPtAgIAkyUBAAAPWc41TP///4gHBX9H8XVK7gGeDllq8TYARA+8Tfsv7L+zPE24eIoIzE0WhHbrqcrTK9VEgEG/hwgB5rdCbvP8g3KYPdV88CvPJnptgQ",
          webpClass = "webp",
          avifClass = "avif";
        function alreadyTested(format) {
          if (window.sessionStorage) {
            var test = window.sessionStorage.getItem(format + "Support");
            if ("false" === test || "true" === test) return "true" === test;
          }
          return null;
        }
        function testFormat(format, imageSrc, callback) {
          var tested = alreadyTested(format);
          if (null === tested) {
            var image = new Image();
            return (
              (image.onload = image.onerror = function () {
                callback(format, 2 === image.height);
              }),
              void (image.src = imageSrc)
            );
          }
          addClass(format, tested);
        }
        function addClass(format, support) {
          if (support) {
            var el = document.documentElement;
            el.classList
              ? el.classList.add("webp" === format ? "webp" : "avif")
              : (el.className += " " + format == "webp" ? "webp" : "avif"),
              window.sessionStorage.setItem(format + "Support", !0);
          } else window.sessionStorage.setItem(format + "Support", !1);
        }
        testFormat(
          "webp",
          "data:image/webp;base64,UklGRi4AAABXRUJQVlA4TCEAAAAvAUAAEB8wAiMwAgSSNtse/cXjxyCCmrYNWPwmHRH9jwMA",
          addClass
        ),
          testFormat("avif", avifImage, addClass);
      })(document);
    </script>

    <script src="https://polyfill.io/v2/polyfill.min.js?features=IntersectionObserver"></script>
  </head>
  <body itemscope itemtype=http://schema.org/WebPage></body>
</html>

    <div class="pie pie1" onclick="document.body.classList.remove('active')">
  <a href="https://www.linkedin.com/in/normansolutions" target="_blank">
    <div class="pie-color pie-color1">
      <span class="pie-color-hyperlink linkedin">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="46"
          height="46"
          viewBox="0 0 24 24"
        >
          <path
            d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"
          /></svg
      ></span>
    </div>
  </a>
</div>
<div class="pie pie2" onclick="document.body.classList.remove('active')">
  <a href="https://twitter.com/normansolutions" target="_blank">
    <div class="pie-color pie-color2">
      <span class="pie-color-hyperlink twitter">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="46"
          height="46"
          viewBox="0 0 24 24"
        >
          <path
            d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"
          />
        </svg>
      </span>
    </div>
  </a>
</div>
<div class="pie pie3" onclick="document.body.classList.remove('active')">
  <a href="/index.xml">
    <div class="pie-color pie-color3">
      <span class="pie-color-hyperlink rss">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="46"
          height="46"
          viewBox="0 0 24 24"
        >
          <path
            d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"
          />
        </svg>
      </span>
    </div>
  </a>
</div>
<div class="menu" onclick="document.body.classList.toggle('active')">
  <svg
    class="hamburger"
    xmlns="http://www.w3.org/2000/svg"
    width="100"
    height="100"
    viewBox="0 0 100 100"
  >
    <g fill="none" stroke="#000" stroke-width="7.999" stroke-linecap="round">
      <path d="M 55,26.000284 L 24.056276,25.999716" />
      <path d="M 24.056276,49.999716 L 75.943724,50.000284" />
      <path d="M 45,73.999716 L 75.943724,74.000284" />
      <path d="M 75.943724,26.000284 L 45,25.999716" />
      <path d="M 24.056276,73.999716 L 55,74.000284" />
    </g>
  </svg>
</div>

    <div class="hero-image">
  <div class="hero-text">
    <h1><a href="\">NS News &amp; Views</a></h1>
    <div class="ns-tagline">By Clive Norman</div>
    
    <h3>38 articles</h3>
    
  </div>
</div>

<div class="ns-social">
  <a target="_blank" href="https://www.linkedin.com/in/normansolutions">
    
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="64"
      height="64"
      viewBox="0 0 64 64"
    >
      <ellipse cy="32" cx="32" ry="32" rx="32" fill="#ffffff"></ellipse>
      <path
        id="path1"
        transform="rotate(0,32,32) translate(14.1963130235672,14) scale(1.450,1.450)  "
        fill="#C62129"
        d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"
      />
    </svg>
  </a>
  <a target="_blank" href="https://www.facebook.com/outoforderbanduk">
    
    <svg
    xmlns="http://www.w3.org/2000/svg"
    width="64"
    height="64"
    viewBox="0 0 64 64"
  >
    <ellipse cy="32" cx="32" ry="32" rx="32" fill="#ffffff"></ellipse>
    <path
      id="path1"
      transform="translate(20,14) scale(1.3,1.3)"
      fill="#C62129"
      d="M22 2v22.58A4.995 4.995 0 0 0 20 24c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5V9h8V2h-11z"
    />
  </svg>
  </a>

  <a target="_blank" href="/index.xml">
    
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="64"
      height="64"
      viewBox="0 0 64 64"
    >
      <ellipse cy="32" cx="32" ry="32" rx="32" fill="#ffffff"></ellipse>
      <path
        id="path1"
        transform="rotate(0,32,32) translate(14.1963130235672,14) scale(1.450,1.450)  "
        fill="#C62129"
        d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-12.832 20c-1.197 0-2.168-.969-2.168-2.165s.971-2.165 2.168-2.165 2.167.969 2.167 2.165-.97 2.165-2.167 2.165zm5.18 0c-.041-4.029-3.314-7.298-7.348-7.339v-3.207c5.814.041 10.518 4.739 10.561 10.546h-3.213zm5.441 0c-.021-7.063-5.736-12.761-12.789-12.792v-3.208c8.83.031 15.98 7.179 16 16h-3.211z"
      />
    </svg>
  </a>
</div>

    
    
<main itemprop="mainEntity" itemscope="" itemtype="http://schema.org/Blog" class="ns-main"> 
  <h1>Why I wrote a console app for accessing the iSAMS API</h1>
  <div class="ns-postdate">  
      <time datetime=2020-10-13&#32;20:11:00&#32;&#43;0000&#32;UTC itemprop="datePublished">Published Tuesday, Oct 13, 2020</time>
      <span class="ns-tags">| Tags: <a href="/tags/isams">iSAMS</a> <a href="/tags/mis">MIS</a> <a href="/tags/c">C#</a> <a href="/tags/database">Database</a> <a href="/tags/sql">SQL</a> </span>   
      <hr/>
    </div>
    <div id="ns-target">
      <p>Firstly, let me register that I <strong><em>much</em></strong> prefer writing raw SQL when interrogating iSAMS than using the official iSAMS REST API - there, I&rsquo;ve said it!</p>
<p><em>However</em>, I do entirely appreciate the necessity for an official API in order to cater for security, consistency, potential database schema changes &amp; futureproofing etc. As such, the need to embrace the iSAMS API is I feel, something of a requirement.</p>
<h2 id="the-project---isams-data-extraction-tool">The Project - iSAMS Data Extraction Tool</h2>
<p>I felt it should be feasible to write a small C# Console Application that you could pass in arguments (be it via the CLI or using Task Scheduler etc) in order to return data. These arguments would be everything from the private keys through to the actual REST API Endpoint needed to extract information - <strong>in short, the tool would do all the token negotiation and heavy lifting, so to speak.</strong></p>
<p><em>In many ways, this could be viewed as a &ldquo;proof of concept&rdquo; - albeit a useful one!</em></p>
<p>In short, it worked! I created a self contained executable (dotNet Core) which allows me to pass in all required parameters, which returns a JSON file containing appropriate data. This data can then be used with other programs or utilities (e.g. Excel, PowerBI, PowerAutomate, PowerShell etc) for further data analysis.</p>
<hr>
<p>Below you will find:</p>
<ol>
<li>Fundamental instructions on how to use this iSAMSDataExtract tool.</li>
<li>A link to my GitHub Repo where you can download the project.</li>
<li>A direct link to a pre-compiled, ready to run executable <em>(it is safe, but you run at your own risk).</em></li>
<li>The raw C# code I wrote, should you wish to copy and paste into your own project.</li>
</ol>
<blockquote>
<p>Please be advised that I&rsquo;m <em>not</em> a full-time developer; this is purely a hobbyist approach and comes with <strong>NO</strong> guarantees - feel free to download, adjust, amend and use as you wish.</p></blockquote>
<hr>
<h2 id="how-to-use-isamsdataextract">How to Use iSAMSDataExtract</h2>
<p>Copy the iSAMSData.exe into a location on your device (e.g. c:\temp) and open a command line from the same place.</p>
<p>You need to pass in 6 parameters; these parameters are separated by a space (see example below).</p>
<p><strong>Required Parameters</strong></p>
<ol>
<li>Token URL</li>
<li>Client ID</li>
<li>Client Secret</li>
<li>API Endpoint URL <em>(iSAMS API endpoint documentation can be found on <a href="https://developerdemo.isams.cloud/Main/swagger/ui/index"> Swagger here</a>)</em></li>
<li>JSON Element</li>
<li>Data Save Location (e.g. c:\temp\data.json)</li>
</ol>
<p><strong>CLI Example</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>isamsdata.exe YOURSCHOOL.isams.cloud/auth/connect/token YOURKEY YOURSECRET YOURSCHOOL.isams.cloud/api/humanresources/employees employees C:\temp\Data.json
</span></span></code></pre></div><hr>
<p>Results are a JSON format text file, which can be used for Power Automate, Excel, PowerBI, PowerShell Scripts, Database Importing or even another self-written program. The advantage with a console app is that this can be very easily run via task scheduler (e.g. a nightly update of data etc)</p>
<p><strong>Sample JSON Screen Shot <em>(albeit blurred out!)</em></strong></p>


<img
src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="
data-src="/img/postimg/13102020Screen.jpg"/>


<hr>
<h4 id="please-note-ensure-you-are-fully-aware-of-where-your-data-is-being-downloaded-to-and-make-certain-this-is-always-secure-and-deleted-when-no-longer-required---you-can-also-restrict-api-access-to-specific-ip-addresses-only-which-is-strongly-recommended---and-keep-those-api-secrets-private">Please Note: Ensure you are fully aware of where your data is being downloaded to and make certain this is <strong>always</strong> secure and deleted when no longer required - you can also restrict API access to specific IP addresses only, which is <strong>strongly</strong> recommended - and keep those API secrets private!</h4>
<hr>
<h2 id="links">Links</h2>
<p><a href="https://github.com/normansolutions/iSAMSDataExtractTool">iSAMS Data Extract Tool</a> - GitHub Repo</p>
<p><a href="https://github.com/normansolutions/iSAMSDataExtractTool/raw/main/iSAMSData.exe">Compiled Stand-Alone Executable</a> - Ready to roll standalone exe <em>(it is safe, but run at your own risk)</em>.</p>
<hr>
<h2 id="code">Code</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.IO;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Net.Http;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Text.RegularExpressions;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Threading.Tasks;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> Newtonsoft.Json;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> Newtonsoft.Json.Linq;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> iSAMSData
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Program</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//Variables</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">readonly</span> HttpClient client = <span style="color:#66d9ef">new</span> HttpClient();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> JObject _token;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> JArray _extractedData;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span> _tokenURL;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span> _clientID;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span> _clientSecret;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span> _apiEndpoint;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span> _elementName;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">string</span> _saveLocation;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> Main(<span style="color:#66d9ef">string</span>[] args)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//Assign console parameters to variables and replace &#34;/&#34; &amp; &#34;\&#34; with &#34;//&#34; &amp; &#34;\\&#34; where appropriate</span>
</span></span><span style="display:flex;"><span>            _tokenURL = Regex.Replace(args[<span style="color:#ae81ff">0</span>], <span style="color:#e6db74">@&#34;//&#34;</span>, <span style="color:#e6db74">&#34;////&#34;</span>);
</span></span><span style="display:flex;"><span>            _clientID = args[<span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>            _clientSecret = args[<span style="color:#ae81ff">2</span>];
</span></span><span style="display:flex;"><span>            _apiEndpoint = Regex.Replace(args[<span style="color:#ae81ff">3</span>], <span style="color:#e6db74">@&#34;//&#34;</span>, <span style="color:#e6db74">&#34;////&#34;</span>);
</span></span><span style="display:flex;"><span>            _elementName = args[<span style="color:#ae81ff">4</span>];
</span></span><span style="display:flex;"><span>            _saveLocation = Regex.Replace(args[<span style="color:#ae81ff">5</span>], <span style="color:#e6db74">@&#34;\\&#34;</span>, <span style="color:#e6db74">&#34;\\\\&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            _extractedData = <span style="color:#66d9ef">new</span> JArray();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            _token = GetToken(_tokenURL, _clientID, _clientSecret).GetAwaiter().GetResult();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> iSAMSDataTotalPages = GetData(<span style="color:#ae81ff">1</span>, _apiEndpoint).GetAwaiter().GetResult();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            JValue _totalPages = (JValue)iSAMSDataTotalPages[<span style="color:#e6db74">&#34;totalPages&#34;</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//Check if _totalPages exists - if not then set a default of 1</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (_totalPages <span style="color:#66d9ef">is</span> <span style="color:#66d9ef">null</span>)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                _totalPages = (JValue)<span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//Where paging is required loop through to build up results set then append together as a single entity</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> page = <span style="color:#ae81ff">1</span>; page &lt;= (<span style="color:#66d9ef">int</span>)_totalPages; page ++)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">var</span> iSAMSData = GetData(page, _apiEndpoint).GetAwaiter().GetResult();
</span></span><span style="display:flex;"><span>                JArray SubElement = (JArray)iSAMSData[_elementName];
</span></span><span style="display:flex;"><span>                _extractedData.Add(SubElement);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//Save final results to local file (e.g. data.json)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">string</span> savedData = <span style="color:#e6db74">@&#34;&#34;</span> + _saveLocation + <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">using</span> (StreamWriter file = File.CreateText(savedData))
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                JsonSerializer serializer = <span style="color:#66d9ef">new</span> JsonSerializer();
</span></span><span style="display:flex;"><span>                serializer.Serialize(file, _extractedData);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//Process for getting authorisation token which is sent with each subsequent request</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">async</span> Task&lt;JObject&gt; GetToken(<span style="color:#66d9ef">string</span> _clientUrl = <span style="color:#e6db74">&#34;youraddressfortoken&#34;</span>, <span style="color:#66d9ef">string</span> _clientID = <span style="color:#e6db74">&#34;yourclientid&#34;</span>, <span style="color:#66d9ef">string</span> _clientSecret = <span style="color:#e6db74">&#34;yourclientsecret&#34;</span>)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> _tokenUrl = <span style="color:#e6db74">&#34;https://&#34;</span> + _clientUrl;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> _tokenSecretRaw = <span style="color:#66d9ef">string</span>.Format(<span style="color:#e6db74">&#34;client_id=&#34;</span> + _clientID + <span style="color:#e6db74">&#34;&amp;client_secret=&#34;</span> + _clientSecret + <span style="color:#e6db74">&#34;&amp;grant_type=client_credentials&amp;scope=restapi&#34;</span>);
</span></span><span style="display:flex;"><span>            StringContent theContent = <span style="color:#66d9ef">new</span> StringContent(_tokenSecretRaw, System.Text.Encoding.UTF8, <span style="color:#e6db74">&#34;application/x-www-form-urlencoded&#34;</span>);
</span></span><span style="display:flex;"><span>            HttpResponseMessage aResponse = <span style="color:#66d9ef">await</span> client.PostAsync(<span style="color:#66d9ef">new</span> Uri(_tokenUrl), theContent);
</span></span><span style="display:flex;"><span>            aResponse.EnsureSuccessStatusCode();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">string</span> content = <span style="color:#66d9ef">await</span> aResponse.Content.ReadAsStringAsync();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> (JObject)<span style="color:#66d9ef">await</span> Task.Run(() =&gt; JObject.Parse(content));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//Process for getting data</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">async</span> Task&lt;JObject&gt; GetData(<span style="color:#66d9ef">int</span> _page = <span style="color:#ae81ff">1</span>, <span style="color:#66d9ef">string</span> urlApi = <span style="color:#e6db74">&#34;yourchosenapiendpoint&#34;</span>)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>                JObject Token = _token; <span style="color:#75715e">//Use cached Token</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">var</span> _extractedToken = Token[<span style="color:#e6db74">&#34;access_token&#34;</span>].ToString();
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">var</span> _baseUrl = <span style="color:#e6db74">&#34;https://&#34;</span> + urlApi + <span style="color:#e6db74">&#34;?page=&#34;</span> + _page;
</span></span><span style="display:flex;"><span>                client.DefaultRequestHeaders.Clear();
</span></span><span style="display:flex;"><span>                client.DefaultRequestHeaders.Add(<span style="color:#e6db74">&#34;Authorization&#34;</span>, <span style="color:#e6db74">&#34;Bearer &#34;</span> + _extractedToken);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">var</span> response = <span style="color:#66d9ef">await</span> client.GetStringAsync(_baseUrl);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> (JObject)<span style="color:#66d9ef">await</span> Task.Run(() =&gt; JObject.Parse(response));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div> 
    </div>
<button class="ns-share-btn" type="button" title="Share this article">
  <svg class="ns-share-icon">
    <use href="#share-icon"></use>
  </svg>
  <span>Share Article</span>
</button>

<svg class="ns-hidden">
  <defs>
    <symbol id="share-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-share"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" y1="2" x2="12" y2="15"></line></symbol> 
   </defs>
</svg>
 </main>
 
   
    <div style="height: 35px"></div>
<footer>
  <div>
    <p>Copyright (c) 2025 Normansolutions</p>
  </div>
</footer>
  
    <script>
    if('serviceWorker' in navigator) {
        navigator.serviceWorker
            .register('/sw.js', { scope: '/' })
            .then(function(registration) {
                
            });
  
        navigator.serviceWorker
            .ready
            .then(function(registration) {
                
            });
    }
  </script>
    






<script
  src="/js/bundle.min.687393ed5d02ad59aaea69fafefb07c4c20dd118b8b01f9ba380cb1330ecd1ea.js?v=ns-fingerprint"
  integrity="sha256-aHOT7V0CrVmq6mn6/vsHxMIN0Ri4sB&#43;bo4DLEzDs0eo="
  defer
  crossorigin="anonymous"
></script>

    <script
  async
  src="https://www.googletagmanager.com/gtag/js?id=UA-37453744-1"
></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());
  gtag("config", "UA-37453744-1");
</script>

    