    
    
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    
<style>
@font-face{font-family:Raleway;font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4WjNPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:200;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4ejMPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4TbMPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4WjMPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4VrMPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4bbLPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4Y_LPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4ejLPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:italic;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Pt_g8zYS_SKggPNyCgSQamb1W0lwk4S4cHLPrQ.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvao4CP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:200;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVtaooCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVuEooCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvaooCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvoooCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVsEpYCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVs9pYCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVtapYCP.ttf) format('truetype')}@font-face{font-family:Raleway;font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/raleway/v34/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVtzpYCP.ttf) format('truetype')}body{font:19px/1.6 Open Sans,Ubuntu,Nimbus Sans L,Avenir,AvenirNext,Segoe UI,Helvetica,Arial,sans-serif;color:#222}html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}a{background-color:transparent}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}*,:after,:before{box-sizing:inherit}html{box-sizing:border-box;font-size:62.5%}body{color:#606c76;font-family:Roboto,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:1.6em;font-weight:300;letter-spacing:.01em;line-height:1.6}hr{border-top:.1rem solid #f4f5f6}.container{margin:0 auto;max-width:112rem;padding:0 2rem;position:relative;width:100%}a{color:#9b4dca}p{margin-bottom:2.5rem}h1,p{margin-top:0}h1{font-weight:300;letter-spacing:-.1rem;margin-bottom:2rem}h1{font-size:4.6rem;line-height:1.2}html{min-height:100%;position:relative;-moz-text-size-adjust:none;-webkit-text-size-adjust:none;text-size-adjust:none;touch-action:manipulation}body,html{background-color:#fff}body{font:19px/1.6 Raleway,Helvetica,Arial,Lucida,sans-serif;color:#222}h1{page-break-after:avoid;page-break-inside:avoid}hr{border:0;border-top:.1rem solid #c62129;margin:3rem 0}a{color:#0070be;border-bottom:.08em solid rgba(0,0,0,.1);padding-bottom:.08em}a{text-decoration:none}main{-webkit-animation:1s fade-in;animation:1s fade-in}@-webkit-keyframes fade-in{0%{opacity:0}to{opacity:1}}@keyframes fade-in{0%{opacity:0}to{opacity:1}}header{text-align:center;margin-bottom:15px}.post header h1 a{color:#222;text-decoration:none;border-bottom:0}.post p:first-child:first-letter{float:left;font-family:Georgia;font-size:71px;line-height:50px;padding-top:5px;padding-right:8px}.ns-main{max-width:750px;padding:0 1.5em;margin:3% auto}.ns-post-summary{color:#000}.ns-readmore{margin-bottom:2.2em}.ns-tags,time{color:#626262;font-size:.85em}.pie{background:#000;border-radius:50%;box-shadow:0 0 4px 5px rgba(0,0,0,.2);height:400px;left:-200px;position:absolute;top:-200px;width:400px;transform:translateX(-200px) translateY(-200px);z-index:1}.pie1{-webkit-clip-path:polygon(200px 200px,344px 450px,0 450px);clip-path:polygon(200px 200px,344px 450px,0 450px)}.pie2{-webkit-clip-path:polygon(200px 200px,344px 450px,450px 344px);clip-path:polygon(200px 200px,344px 450px,450px 344px)}.pie3{-webkit-clip-path:polygon(200px 200px,450px 0,450px 344px);clip-path:polygon(200px 200px,450px 0,450px 344px)}.pie-color{width:100%;height:100%;border-radius:50%}.pie-color-hyperlink{font-size:1.7rem;letter-spacing:.05em;font-weight:700;color:#fff}.pie-color1{background:linear-gradient(135deg,#c62129,#c62129);-webkit-clip-path:polygon(200px 200px,344px 450px,0 450px);clip-path:polygon(200px 200px,344px 450px,0 450px)}.pie-color2{background:linear-gradient(135deg,#fff,#fff);-webkit-clip-path:polygon(200px 200px,344px 450px,450px 344px);clip-path:polygon(200px 200px,344px 450px,450px 344px)}.pie-color3{background:linear-gradient(135deg,#c62129,#c62129);-webkit-clip-path:polygon(200px 200px,450px 0,450px 344px);clip-path:polygon(200px 200px,450px 0,450px 344px)}.linkedin{left:208px;position:absolute;top:320px}.twitter{left:282px;top:279px}.rss,.twitter{position:absolute;width:46px}.rss{left:324px;top:210px}.menu{background:#fff;border-radius:50%;box-shadow:0 0 4px 5px rgba(0,0,0,.2);height:200px;left:-100px;position:absolute;top:-100px;width:200px;z-index:1}.hamburger{height:46px;left:58%;position:relative;top:58%;width:46px}.hamburger path:first-child{transform-origin:25% 29%}.hamburger path:nth-child(2){transform-origin:50% 50%}.hamburger path:nth-child(3){transform-origin:75% 72%}.hamburger path:nth-child(4){transform-origin:75% 29%}.hamburger path:nth-child(5){transform-origin:25% 72%}.hero-image{background-image:linear-gradient(rgba(0,0,0,.5),rgba(0,0,0,.5)),url('https://normansolutions.co.uk/img/BandHeader.jpg?v=fingerprint')}.hero-image{min-height:280px;height:50%;box-shadow:-5px 24px 65px -31px rgba(0,0,0,.75);background-position:50%;background-repeat:no-repeat;background-size:cover;position:relative}.hero-text{text-align:center;color:#fff;position:absolute;top:50%;left:50%;background-color:rgba(0,0,0,.5);padding:10px;margin-top:10px;margin-bottom:10px;border-radius:10px;transform:translate(-50%,-50%)}@media (min-width:1024px) and (max-width:1366px) and (orientation:portrait){.hero-text{width:80%}}@media (min-width:1024px) and (max-width:1366px) and (orientation:landscape){.hero-text{width:40%}}.hero-text a{color:#fff}.hero-text a,.hero-text a :visited{border-bottom:0}.ns-tagline{padding-top:25px;padding-left:15px;padding-right:15px}.ns-social,.ns-tagline{margin:auto;max-width:800px;position:relative;text-align:center}footer{position:fixed;color:#fff;height:45px;background-color:#000;bottom:0;text-align:center;width:100%;z-index:9999}footer p{padding-top:8px}
</style>


    <title>Automating Azure App Registrations with PowerShell</title>
    <meta
      name="Keywords"
      content="Technology, IT, Education, Software, Security"
    />
    <meta
      name="Description"
      content="Head of Information Services, Web Technologist &amp;amp; Musician, based on the Wiltshire, Dorset &amp; Somerset border in the UK.  Offering honest independent advice on all things web, security and general IT; with a splash of added music for the soul."
    />

    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1"
    />
    <meta name="robots" content="index,follow" />
    <meta name="Author" content="normansolutions.co.uk" />
    <meta name="language" content="EN" />
    <meta name="Classification" content="" />
    <meta
      name="copyright"
      content="Copyright (c) 2025 'normansolutions.co.uk' All rights reserved."
    />
    <meta name="revisit-after" content="7 days" />
    <meta name="document-classification" content="Technology" />
    <meta name="document-type" content="Public" />
    <meta name="document-rating" content="Safe for Kids" />
    <meta name="document-distribution" content="Global" />
    <link rel="me" type="text/html" href="https://twitter.com/normansolutions" />
    <link
      type="application/rsd+xml"
      rel="edituri"
      title="RSD"
      href="robots.txt"
    />
    <link rel="canonical" href="https://normansolutions.co.uk" />
    <meta name="application-name" content="Normansolutions" />
    <meta name="msapplication-TileColor" content="#ffffff" />

    <meta property="og:title" content="NS News and Views" />
    <meta property="og:type" content=article />   
    <meta
      property="og:description"
      content="Head of Information Services, Web Technologist &amp;amp; Musician, based on the Wiltshire, Dorset &amp; Somerset border in the UK.  Offering honest independent advice on all things web, security and general IT; with a splash of added music for the soul."
    />
    <meta
      property="og:image"
      content="https://normansolutions.co.uk/appicons/Icon-568.jpg"
    />
    <meta property="og:url" content="https://normansolutions.co.uk" />
    <meta property=og:description content="Head of Information Services, Web Technologist &amp;amp; Musician, based on the Wiltshire, Dorset &amp; Somerset border in the UK.  Offering honest independent advice on all things web, security and general IT; with a splash of added music for the soul.">

    <meta name="twitter:title" content="NS News and Views" />
    <meta
      name="twitter:description"
      content="Head of Information Services, Web Technologist &amp;amp; Musician, based on the Wiltshire, Dorset &amp; Somerset border in the UK.  Offering honest independent advice on all things web, security and general IT; with a splash of added music for the soul."    />
    <meta name="twitter:image" content="/appicons/Icon-568.jpg" />
    <meta name="twitter:card" content="summary_large_image" />
    <link rel="manifest" href="/manifest.json" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    















<link
  rel="preload"
  href="/css/main.min.0a04472ead744c1f1f8bbbb8024fda23095546a155e5ba9679fa477f14ce6ef1.css?v=ns-fingerprint"
  integrity="sha256-CgRHLq10TB8fi7u4Ak/aIwlVRqFV5bqWefpHfxTObvE="
  as="style"
  crossorigin="anonymous"
/>
<link
  rel="stylesheet"
  href="/css/main.min.0a04472ead744c1f1f8bbbb8024fda23095546a155e5ba9679fa477f14ce6ef1.css?v=ns-fingerprint"
  integrity="sha256-CgRHLq10TB8fi7u4Ak/aIwlVRqFV5bqWefpHfxTObvE="
  media="print"
  onload="this.media='all'"
  crossorigin="anonymous"
/>

    

    
    <script>
      !(function (document) {
        "use strict";
        var webpImage,
          avifImage =
            "data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAF0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgS0AAAAAABNjb2xybmNseAACAAIAAIAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAGVtZGF0EgAKBzgAPtAgIAkyUBAAAPWc41TP///4gHBX9H8XVK7gGeDllq8TYARA+8Tfsv7L+zPE24eIoIzE0WhHbrqcrTK9VEgEG/hwgB5rdCbvP8g3KYPdV88CvPJnptgQ",
          webpClass = "webp",
          avifClass = "avif";
        function alreadyTested(format) {
          if (window.sessionStorage) {
            var test = window.sessionStorage.getItem(format + "Support");
            if ("false" === test || "true" === test) return "true" === test;
          }
          return null;
        }
        function testFormat(format, imageSrc, callback) {
          var tested = alreadyTested(format);
          if (null === tested) {
            var image = new Image();
            return (
              (image.onload = image.onerror = function () {
                callback(format, 2 === image.height);
              }),
              void (image.src = imageSrc)
            );
          }
          addClass(format, tested);
        }
        function addClass(format, support) {
          if (support) {
            var el = document.documentElement;
            el.classList
              ? el.classList.add("webp" === format ? "webp" : "avif")
              : (el.className += " " + format == "webp" ? "webp" : "avif"),
              window.sessionStorage.setItem(format + "Support", !0);
          } else window.sessionStorage.setItem(format + "Support", !1);
        }
        testFormat(
          "webp",
          "data:image/webp;base64,UklGRi4AAABXRUJQVlA4TCEAAAAvAUAAEB8wAiMwAgSSNtse/cXjxyCCmrYNWPwmHRH9jwMA",
          addClass
        ),
          testFormat("avif", avifImage, addClass);
      })(document);
    </script>

    <script src="https://polyfill.io/v2/polyfill.min.js?features=IntersectionObserver"></script>
  </head>
  <body itemscope itemtype=http://schema.org/WebPage></body>
</html>

    <div class="pie pie1" onclick="document.body.classList.remove('active')">
  <a href="https://www.linkedin.com/in/normansolutions" target="_blank">
    <div class="pie-color pie-color1">
      <span class="pie-color-hyperlink linkedin">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="46"
          height="46"
          viewBox="0 0 24 24"
        >
          <path
            d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"
          /></svg
      ></span>
    </div>
  </a>
</div>
<div class="pie pie2" onclick="document.body.classList.remove('active')">
  <a href="https://twitter.com/normansolutions" target="_blank">
    <div class="pie-color pie-color2">
      <span class="pie-color-hyperlink twitter">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="46"
          height="46"
          viewBox="0 0 24 24"
        >
          <path
            d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"
          />
        </svg>
      </span>
    </div>
  </a>
</div>
<div class="pie pie3" onclick="document.body.classList.remove('active')">
  <a href="/index.xml">
    <div class="pie-color pie-color3">
      <span class="pie-color-hyperlink rss">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="46"
          height="46"
          viewBox="0 0 24 24"
        >
          <path
            d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"
          />
        </svg>
      </span>
    </div>
  </a>
</div>
<div class="menu" onclick="document.body.classList.toggle('active')">
  <svg
    class="hamburger"
    xmlns="http://www.w3.org/2000/svg"
    width="100"
    height="100"
    viewBox="0 0 100 100"
  >
    <g fill="none" stroke="#000" stroke-width="7.999" stroke-linecap="round">
      <path d="M 55,26.000284 L 24.056276,25.999716" />
      <path d="M 24.056276,49.999716 L 75.943724,50.000284" />
      <path d="M 45,73.999716 L 75.943724,74.000284" />
      <path d="M 75.943724,26.000284 L 45,25.999716" />
      <path d="M 24.056276,73.999716 L 55,74.000284" />
    </g>
  </svg>
</div>

    <div class="hero-image">
  <div class="hero-text">
    <h1><a href="\">NS News &amp; Views</a></h1>
    <div class="ns-tagline">By Clive Norman</div>
    
    <a class="ns-list-articles" href="/?post=allposts">List all 38 articles</a>
    
  </div>
</div>

<div class="ns-social">
  <a target="_blank" href="https://www.linkedin.com/in/normansolutions">
    
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="64"
      height="64"
      viewBox="0 0 64 64"
    >
      <ellipse cy="32" cx="32" ry="32" rx="32" fill="#ffffff"></ellipse>
      <path
        id="path1"
        transform="rotate(0,32,32) translate(14.1963130235672,14) scale(1.450,1.450)  "
        fill="#C62129"
        d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"
      />
    </svg>
  </a>
  <a target="_blank" href="https://twitter.com/normansolutions">
    
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="64"
      height="64"
      viewBox="0 0 64 64"
    >
      <ellipse cy="32" cx="32" ry="32" rx="32" fill="#ffffff"></ellipse>
      <path
        id="path1"
        transform="rotate(0,32,32) translate(14.1963130235672,14) scale(1.450,1.450)  "
        fill="#C62129"
        d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-.139 9.237c.209 4.617-3.234 9.765-9.33 9.765-1.854 0-3.579-.543-5.032-1.475 1.742.205 3.48-.278 4.86-1.359-1.437-.027-2.649-.976-3.066-2.28.515.098 1.021.069 1.482-.056-1.579-.317-2.668-1.739-2.633-3.26.442.246.949.394 1.486.411-1.461-.977-1.875-2.907-1.016-4.383 1.619 1.986 4.038 3.293 6.766 3.43-.479-2.053 1.08-4.03 3.199-4.03.943 0 1.797.398 2.395 1.037.748-.147 1.451-.42 2.086-.796-.246.767-.766 1.41-1.443 1.816.664-.08 1.297-.256 1.885-.517-.439.656-.996 1.234-1.639 1.697z"
      />
    </svg>
  </a>

  <a target="_blank" href="/index.xml">
    
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="64"
      height="64"
      viewBox="0 0 64 64"
    >
      <ellipse cy="32" cx="32" ry="32" rx="32" fill="#ffffff"></ellipse>
      <path
        id="path1"
        transform="rotate(0,32,32) translate(14.1963130235672,14) scale(1.450,1.450)  "
        fill="#C62129"
        d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-12.832 20c-1.197 0-2.168-.969-2.168-2.165s.971-2.165 2.168-2.165 2.167.969 2.167 2.165-.97 2.165-2.167 2.165zm5.18 0c-.041-4.029-3.314-7.298-7.348-7.339v-3.207c5.814.041 10.518 4.739 10.561 10.546h-3.213zm5.441 0c-.021-7.063-5.736-12.761-12.789-12.792v-3.208c8.83.031 15.98 7.179 16 16h-3.211z"
      />
    </svg>
  </a>
</div>

    
    
<main itemprop="mainEntity" itemscope="" itemtype="http://schema.org/Blog" class="ns-main"> 
  <h1>Automating Azure App Registrations with PowerShell</h1>
  <div class="ns-postdate">  
      <time datetime=2024-03-01&#32;21:38:20&#32;&#43;0000&#32;UTC itemprop="datePublished">Published Friday, Mar 1, 2024</time>
      <span class="ns-tags">| Tags: <a href="/tags/powershell">PowerShell</a> <a href="/tags/azure">Azure</a> <a href="/tags/sysadmin">SysAdmin</a> </span>   
      <hr/>
    </div>
    <div id="ns-target">
      <p>It has been a while since I last blogged - life has certainly been busy!</p>
<p>Over the past two years I&rsquo;ve somewhat immersed myself in PowerShell. While I wouldn&rsquo;t claim to be a PowerShell Guru, my knowledge has substantially grown, thanks in part to splendid collaboration with some exceptional colleagues.</p>
<p>In this post, I&rsquo;ll aim to demonstrate how you can leverage PowerShell (on-prem) to automate the creation of Azure App Registrations.</p>
<h2 id="the-problem-manual-app-registration"><strong>The Problem: Manual App Registration</strong></h2>
<p>Creating Azure App Registrations manually can be time-consuming and error-prone. This can be addressed by automating the process using PowerShell.</p>
<p>The purpose of this script:</p>
<ul>
<li>Take a list (CSV) of App Registration requirements</li>
<li>For each item, automate the creation of Azure App Registrations</li>
<li>Update the appropriate Azure App Registration Notes field (as required)</li>
<li>Create a local certificate and upload to the newly created App Reg</li>
<li>Export PFX certificate</li>
</ul>
<p><em>Please be advised this is more a reference script; I have removed any logging aspects (which are usually an absolute <!-- raw HTML omitted -->must<!-- raw HTML omitted --> for auditing and debugging) and of course, you may wish to <!-- raw HTML omitted -->not<!-- raw HTML omitted --> create self-signed certificates etc. This should be seen purely as a proof of concept starting point for your own requirements.</em></p>
<h2 id="the-powershell-solution"><strong>The PowerShell Solution</strong></h2>
<h3 id="1-prepare-your-csv-list"><strong>1. Prepare Your CSV List</strong></h3>
<p>Start by compiling a CSV list containing the necessary details for your App Registrations. In this example the CSV is expected to have the below columns, but of course, you can adjust to your own requirements:</p>
<ul>
<li><!-- raw HTML omitted -->Name<!-- raw HTML omitted --> (Name of Azure App Registration)</li>
<li><!-- raw HTML omitted -->Operational_Location<!-- raw HTML omitted --> (Location where script will be used)</li>
<li><!-- raw HTML omitted -->Script_Owned_By<!-- raw HTML omitted --> (Who owns the script)</li>
<li><!-- raw HTML omitted -->Script_Author<!-- raw HTML omitted --> (Who wrote the script)</li>
<li><!-- raw HTML omitted -->Status<!-- raw HTML omitted --> (This column is left blank and automatically updated)</li>
</ul>
<h3 id="2-write-your-powershell-script"><strong>2. Write Your PowerShell Script</strong></h3>
<p>Here&rsquo;s a simplified version of the script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Script to RunAs Administrator for certificate generation</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span><span style="color:#66d9ef">Requires</span> <span style="color:#66d9ef">-RunAsAdministrator</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Initialize variables</span>
</span></span><span style="display:flex;"><span>$appFile = $null
</span></span><span style="display:flex;"><span>$app = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>$scriptPath = Split-Path -Parent $MyInvocation.MyCommand.Path
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Connect to MgGraph with appropriate scope</span>
</span></span><span style="display:flex;"><span>Connect-MgGraph -Scopes <span style="color:#e6db74">&#34;Application.ReadWrite.All&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Import CSV Data from $scriptPath\AppData.csv</span>
</span></span><span style="display:flex;"><span>$appFile = Import-Csv -Path <span style="color:#e6db74">&#34;</span>$scriptPath<span style="color:#e6db74">\AppData.csv&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Loop through CSV where Status is not &#39;Done&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">foreach</span> ($app <span style="color:#66d9ef">in</span> ($appFile | Where-Object Status <span style="color:#f92672">-ne</span> <span style="color:#e6db74">&#39;Done&#39;</span>)) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">## CREATE AAD APPLICATION ##</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Initialize variables in loop</span>
</span></span><span style="display:flex;"><span>    $appName = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    $appExist = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    $operationLocation = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    $scriptOwnedBy = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    $scriptAuthor = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    $appNotes = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    $appCreate = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    $appObjectID = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    $date = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    $certName = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    $cert = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    $keyCreds = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    $appName = $app.Name.Trim()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Check if $appName has any problem characters in title</span>
</span></span><span style="display:flex;"><span>    $pattern = <span style="color:#e6db74">&#39;[a-zA-Z0-9-_]&#39;</span>
</span></span><span style="display:flex;"><span>    $nonAplhaDetected = $appName <span style="color:#f92672">-replace</span> $pattern, <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">If</span> (($nonAplhaDetected).Length <span style="color:#f92672">-gt</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        Add-Type -AssemblyName PresentationCore, PresentationFramework
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">&lt;# If $appName does have problem characters in title
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        show appropriate message on screen and exit script #&gt;</span>
</span></span><span style="display:flex;"><span>        $buttonType = [<span style="color:#66d9ef">System.Windows.MessageBoxButton</span>]::Ok
</span></span><span style="display:flex;"><span>        $messageIcon = [<span style="color:#66d9ef">System.Windows.MessageBoxImage</span>]::Error
</span></span><span style="display:flex;"><span>        $messageBody = <span style="color:#e6db74">&#34;You have some non-alphanumeric characters in your App Reg </span>$appName<span style="color:#e6db74"> which could cause issues - suggestion is to remove these characters in the csv file and restart the script.  Please Note: No action has been taken, no App Reg or Certificate has been created at this stage.&#34;</span>
</span></span><span style="display:flex;"><span>        $messageTitle = <span style="color:#e6db74">&#34;Potential Problem Characters Detected in </span>$appName<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">System.Windows.MessageBox</span>]::Show($messageBody, $messageTitle, $buttonType, $messageIcon)
</span></span><span style="display:flex;"><span>        Exit
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Check that $appName doesn&#39;t exist in Azure</span>
</span></span><span style="display:flex;"><span>    $appExist = (Get-MgApplication | Where-Object { $_.DisplayName <span style="color:#f92672">-eq</span> $appName }).Count
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ($appExist <span style="color:#f92672">-lt</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        $operationLocation = $app.Operational_Location
</span></span><span style="display:flex;"><span>        $scriptOwnedBy = $app.Script_Owned_By
</span></span><span style="display:flex;"><span>        $scriptAuthor = $app.Script_Author
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Create new App Reg and build up Notes field</span>
</span></span><span style="display:flex;"><span>        $appCreate = New-MgApplication -DisplayName $appName
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        $appObjectID = $appCreate.Id
</span></span><span style="display:flex;"><span>        $appNotes = <span style="color:#e6db74">&#39;Operational Location: &#39;</span> + $operationLocation + [<span style="color:#66d9ef">System.Environment</span>]::NewLine + <span style="color:#e6db74">&#39;Script Owned By: &#39;</span> + $scriptOwnedBy + [<span style="color:#66d9ef">System.Environment</span>]::NewLine + <span style="color:#e6db74">&#39;Script Author: &#39;</span> + $scriptAuthor | Out-String
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Wait 5 seconds after $appName has been created</span>
</span></span><span style="display:flex;"><span>        Start-Sleep -Seconds <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">## CREATE &amp; ADD CERTIFICATE TO AZURE APP ##</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Create Self-Signed Certificate for $appName</span>
</span></span><span style="display:flex;"><span>        $date = (Get-Date).ToString(<span style="color:#e6db74">&#34;yyyyMMdd-hhmmss&#34;</span>)
</span></span><span style="display:flex;"><span>        $certName = <span style="color:#e6db74">&#34;</span>$appName<span style="color:#e6db74">-</span>$date<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        $cert = New-SelfSignedCertificate -Subject <span style="color:#e6db74">&#34;CN=</span>$certName<span style="color:#e6db74">&#34;</span> -CertStoreLocation <span style="color:#e6db74">&#34;Cert:\LocalMachine\My&#34;</span> -KeyExportPolicy Exportable -KeySpec Signature -KeyLength <span style="color:#ae81ff">2048</span> -KeyAlgorithm RSA -HashAlgorithm SHA256
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Set cert file path based on script path and cert folder</span>
</span></span><span style="display:flex;"><span>        $certFilePath = <span style="color:#e6db74">&#34;</span>$scriptPath<span style="color:#e6db74">\Certificates&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Check if cert folder exists and if not create it&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">-not</span>(Test-Path $certFilePath)) {
</span></span><span style="display:flex;"><span>            New-Item $certFilePath -ItemType Directory | Out-Null
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Export Self-Signed Certificate for $appName</span>
</span></span><span style="display:flex;"><span>        Export-Certificate -Cert $cert -FilePath <span style="color:#e6db74">&#34;</span>$scriptPath<span style="color:#e6db74">\Certificates\</span>$certName<span style="color:#e6db74">.cer&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        $graphAPICertificate = Get-ChildItem -Path <span style="color:#e6db74">&#34;Cert:\LocalMachine\MY&#34;</span> | Where-Object { $_.Subject <span style="color:#f92672">-match</span> $certName } | Select-Object Thumbprint
</span></span><span style="display:flex;"><span>        $graphAPICertificateThumbprint = $graphAPICertificate.Thumbprint
</span></span><span style="display:flex;"><span>        $graphClientcertificate = Get-ChildItem <span style="color:#e6db74">&#34;Cert:\LocalMachine\My\</span>$graphAPICertificateThumbprint<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Create pfx Export for importing onto another server</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># General certificate password and copy to clipboard&#34;</span>
</span></span><span style="display:flex;"><span>        $mytxtpwd = -join (<span style="color:#e6db74">&#39;abcdefghkmnrstuvwxyzABCDEFGHKLMNPRSTUVWXYZ23456789$%&amp;*#&#39;</span>.ToCharArray() | Get-Random -Count <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>        Add-Type -AssemblyName PresentationCore, PresentationFramework
</span></span><span style="display:flex;"><span>        $buttonType = [<span style="color:#66d9ef">System.Windows.MessageBoxButton</span>]::Ok
</span></span><span style="display:flex;"><span>        $messageIcon = [<span style="color:#66d9ef">System.Windows.MessageBoxImage</span>]::Information
</span></span><span style="display:flex;"><span>        $messageBody = <span style="color:#e6db74">&#34;Your certificate password is </span>$mytxtpwd<span style="color:#e6db74"> - this has been copied to your clipboard - you will need this to import the pfx&#34;</span>
</span></span><span style="display:flex;"><span>        $messageTitle = <span style="color:#e6db74">&#34;PFX Certificate Password&#34;</span>
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">System.Windows.MessageBox</span>]::Show($messageBody, $messageTitle, $buttonType, $messageIcon)
</span></span><span style="display:flex;"><span>        $mytxtpwd | clip
</span></span><span style="display:flex;"><span>        $mypwd = ConvertTo-SecureString -String $mytxtpwd -Force -AsPlainText
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Export Self-Signed PFX Exportable Certificate for $appName</span>
</span></span><span style="display:flex;"><span>        $graphClientcertificate | Export-PfxCertificate -FilePath $scriptPath\Certificates\$certName.pfx -Password $mypwd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Create a keyCredential (Certificate) for App</span>
</span></span><span style="display:flex;"><span>        $keyCreds = @{
</span></span><span style="display:flex;"><span>            Type  = <span style="color:#e6db74">&#34;AsymmetricX509Cert&#34;</span>;
</span></span><span style="display:flex;"><span>            Usage = <span style="color:#e6db74">&#34;Verify&#34;</span>;
</span></span><span style="display:flex;"><span>            key   = $graphClientcertificate.RawData
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Update $appName Notes</span>
</span></span><span style="display:flex;"><span>            Update-MgApplication -ApplicationId $aPPObjectID -Notes $appNotes
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Wait 5 seconds after $appName has updated &#39;Notes&#39; field</span>
</span></span><span style="display:flex;"><span>            Start-Sleep -Seconds <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Update $appName Certificate</span>
</span></span><span style="display:flex;"><span>            Update-MgApplication -ApplicationId $appObjectID -KeyCredentials $keyCreds
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Set $appName Status in csv as &#39;Done&#39;</span>
</span></span><span style="display:flex;"><span>            $app.Status = <span style="color:#e6db74">&#34;Done&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">catch</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Log and handle error</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Wait 5 seconds after $appName has updated certificate and completed process</span>
</span></span><span style="display:flex;"><span>        Start-Sleep -Seconds <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Log and handle error that $appName already exists in Azure - no further action taken</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Save CSV</span>
</span></span><span style="display:flex;"><span>$appFile | Export-Csv -Path <span style="color:#e6db74">&#34;</span>$scriptPath<span style="color:#e6db74">\AppData.csv&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Disconnect-MgGraph
</span></span></code></pre></div><h2 id="conclusion"><strong>Conclusion</strong></h2>
<p>By automating Azure App Registrations with PowerShell, this will save time, reduce errors, and maintain consistency. Please remember to adapt this approach to fit your unique scenario.</p>
<hr>
 
    </div>
<button class="ns-share-btn" type="button" title="Share this article">
  <svg class="ns-share-icon">
    <use href="#share-icon"></use>
  </svg>
  <span>Share Article</span>
</button>

<svg class="ns-hidden">
  <defs>
    <symbol id="share-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-share"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" y1="2" x2="12" y2="15"></line></symbol> 
   </defs>
</svg>
 </main>
 
   
    <div style="height: 35px"></div>
<footer>
  <div>
    <p>Copyright (c) 2025 Normansolutions</p>
  </div>
</footer>
  
    <script>
    if('serviceWorker' in navigator) {
        navigator.serviceWorker
            .register('/sw.js', { scope: '/' })
            .then(function(registration) {
                
            });
  
        navigator.serviceWorker
            .ready
            .then(function(registration) {
                
            });
    }
  </script>
    






<script
  src="/js/bundle.min.687393ed5d02ad59aaea69fafefb07c4c20dd118b8b01f9ba380cb1330ecd1ea.js?v=ns-fingerprint"
  integrity="sha256-aHOT7V0CrVmq6mn6/vsHxMIN0Ri4sB&#43;bo4DLEzDs0eo="
  defer
  crossorigin="anonymous"
></script>

    <script
  async
  src="https://www.googletagmanager.com/gtag/js?id=UA-37453744-1"
></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());
  gtag("config", "UA-37453744-1");
</script>

    